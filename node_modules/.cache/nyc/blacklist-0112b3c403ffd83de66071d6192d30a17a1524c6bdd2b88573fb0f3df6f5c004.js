'use strict';function cov_2mp7mg5zi(){var path="/home/mrahmatu/project2/fall23-nodebb-generation-z/src/socket.io/blacklist.js";var hash="ee22be69a7bab4f75c1ccc2bb8f49ff5ef70a6be";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/mrahmatu/project2/fall23-nodebb-generation-z/src/socket.io/blacklist.js",statementMap:{"0":{start:{line:4,column:13},end:{line:4,column:31}},"1":{start:{line:5,column:13},end:{line:5,column:31}},"2":{start:{line:6,column:15},end:{line:6,column:35}},"3":{start:{line:8,column:24},end:{line:8,column:38}},"4":{start:{line:10,column:0},end:{line:12,column:2}},"5":{start:{line:11,column:4},end:{line:11,column:47}},"6":{start:{line:14,column:0},end:{line:16,column:2}},"7":{start:{line:15,column:4},end:{line:15,column:43}},"8":{start:{line:18,column:0},end:{line:20,column:2}},"9":{start:{line:19,column:4},end:{line:19,column:45}},"10":{start:{line:23,column:31},end:{line:23,column:72}},"11":{start:{line:24,column:4},end:{line:26,column:5}},"12":{start:{line:25,column:8},end:{line:25,column:51}},"13":{start:{line:27,column:4},end:{line:27,column:39}},"14":{start:{line:28,column:4},end:{line:33,column:7}},"15":{start:{line:36,column:0},end:{line:36,column:41}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:27},end:{line:10,column:28}},loc:{start:{line:10,column:57},end:{line:12,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:14,column:23},end:{line:14,column:24}},loc:{start:{line:14,column:54},end:{line:16,column:1}},line:14},"2":{name:"(anonymous_2)",decl:{start:{line:18,column:26},end:{line:18,column:27}},loc:{start:{line:18,column:56},end:{line:20,column:1}},line:18},"3":{name:"blacklist",decl:{start:{line:22,column:15},end:{line:22,column:24}},loc:{start:{line:22,column:47},end:{line:34,column:1}},line:22}},branchMap:{"0":{loc:{start:{line:24,column:4},end:{line:26,column:5}},type:"if",locations:[{start:{line:24,column:4},end:{line:26,column:5}},{start:{line:24,column:4},end:{line:26,column:5}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ee22be69a7bab4f75c1ccc2bb8f49ff5ef70a6be"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2mp7mg5zi=function(){return actualCoverage;};}return actualCoverage;}cov_2mp7mg5zi();const user=(cov_2mp7mg5zi().s[0]++,require('../user'));const meta=(cov_2mp7mg5zi().s[1]++,require('../meta'));const events=(cov_2mp7mg5zi().s[2]++,require('../events'));const SocketBlacklist=(cov_2mp7mg5zi().s[3]++,module.exports);cov_2mp7mg5zi().s[4]++;SocketBlacklist.validate=async function(socket,data){cov_2mp7mg5zi().f[0]++;cov_2mp7mg5zi().s[5]++;return meta.blacklist.validate(data.rules);};cov_2mp7mg5zi().s[6]++;SocketBlacklist.save=async function(socket,rules){cov_2mp7mg5zi().f[1]++;cov_2mp7mg5zi().s[7]++;await blacklist(socket,'save',rules);};cov_2mp7mg5zi().s[8]++;SocketBlacklist.addRule=async function(socket,rule){cov_2mp7mg5zi().f[2]++;cov_2mp7mg5zi().s[9]++;await blacklist(socket,'addRule',rule);};async function blacklist(socket,method,rule){cov_2mp7mg5zi().f[3]++;const isAdminOrGlobalMod=(cov_2mp7mg5zi().s[10]++,await user.isAdminOrGlobalMod(socket.uid));cov_2mp7mg5zi().s[11]++;if(!isAdminOrGlobalMod){cov_2mp7mg5zi().b[0][0]++;cov_2mp7mg5zi().s[12]++;throw new Error('[[error:no-privileges]]');}else{cov_2mp7mg5zi().b[0][1]++;}cov_2mp7mg5zi().s[13]++;await meta.blacklist[method](rule);cov_2mp7mg5zi().s[14]++;await events.log({type:`ip-blacklist-${method}`,uid:socket.uid,ip:socket.ip,rule:rule});}cov_2mp7mg5zi().s[15]++;require('../promisify')(SocketBlacklist);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMm1wN21nNXppIiwicGF0aCIsImhhc2giLCJnbG9iYWwiLCJGdW5jdGlvbiIsImdjdiIsImNvdmVyYWdlRGF0YSIsInN0YXRlbWVudE1hcCIsInN0YXJ0IiwibGluZSIsImNvbHVtbiIsImVuZCIsImZuTWFwIiwibmFtZSIsImRlY2wiLCJsb2MiLCJicmFuY2hNYXAiLCJ0eXBlIiwibG9jYXRpb25zIiwicyIsImYiLCJiIiwiX2NvdmVyYWdlU2NoZW1hIiwiY292ZXJhZ2UiLCJhY3R1YWxDb3ZlcmFnZSIsInVzZXIiLCJyZXF1aXJlIiwibWV0YSIsImV2ZW50cyIsIlNvY2tldEJsYWNrbGlzdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJ2YWxpZGF0ZSIsInNvY2tldCIsImRhdGEiLCJibGFja2xpc3QiLCJydWxlcyIsInNhdmUiLCJhZGRSdWxlIiwicnVsZSIsIm1ldGhvZCIsImlzQWRtaW5Pckdsb2JhbE1vZCIsInVpZCIsIkVycm9yIiwibG9nIiwiaXAiXSwic291cmNlcyI6WyJibGFja2xpc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IHVzZXIgPSByZXF1aXJlKCcuLi91c2VyJyk7XG5jb25zdCBtZXRhID0gcmVxdWlyZSgnLi4vbWV0YScpO1xuY29uc3QgZXZlbnRzID0gcmVxdWlyZSgnLi4vZXZlbnRzJyk7XG5cbmNvbnN0IFNvY2tldEJsYWNrbGlzdCA9IG1vZHVsZS5leHBvcnRzO1xuXG5Tb2NrZXRCbGFja2xpc3QudmFsaWRhdGUgPSBhc3luYyBmdW5jdGlvbiAoc29ja2V0LCBkYXRhKSB7XG4gICAgcmV0dXJuIG1ldGEuYmxhY2tsaXN0LnZhbGlkYXRlKGRhdGEucnVsZXMpO1xufTtcblxuU29ja2V0QmxhY2tsaXN0LnNhdmUgPSBhc3luYyBmdW5jdGlvbiAoc29ja2V0LCBydWxlcykge1xuICAgIGF3YWl0IGJsYWNrbGlzdChzb2NrZXQsICdzYXZlJywgcnVsZXMpO1xufTtcblxuU29ja2V0QmxhY2tsaXN0LmFkZFJ1bGUgPSBhc3luYyBmdW5jdGlvbiAoc29ja2V0LCBydWxlKSB7XG4gICAgYXdhaXQgYmxhY2tsaXN0KHNvY2tldCwgJ2FkZFJ1bGUnLCBydWxlKTtcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIGJsYWNrbGlzdChzb2NrZXQsIG1ldGhvZCwgcnVsZSkge1xuICAgIGNvbnN0IGlzQWRtaW5Pckdsb2JhbE1vZCA9IGF3YWl0IHVzZXIuaXNBZG1pbk9yR2xvYmFsTW9kKHNvY2tldC51aWQpO1xuICAgIGlmICghaXNBZG1pbk9yR2xvYmFsTW9kKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1tlcnJvcjpuby1wcml2aWxlZ2VzXV0nKTtcbiAgICB9XG4gICAgYXdhaXQgbWV0YS5ibGFja2xpc3RbbWV0aG9kXShydWxlKTtcbiAgICBhd2FpdCBldmVudHMubG9nKHtcbiAgICAgICAgdHlwZTogYGlwLWJsYWNrbGlzdC0ke21ldGhvZH1gLFxuICAgICAgICB1aWQ6IHNvY2tldC51aWQsXG4gICAgICAgIGlwOiBzb2NrZXQuaXAsXG4gICAgICAgIHJ1bGU6IHJ1bGUsXG4gICAgfSk7XG59XG5cbnJlcXVpcmUoJy4uL3Byb21pc2lmeScpKFNvY2tldEJsYWNrbGlzdCk7XG4iXSwibWFwcGluZ3MiOiJBQUNBLFlBQVksQ0FBQyxTQUFBQSxjQUFBLE1BQUFDLElBQUEscUZBQUFDLElBQUEsZ0RBQUFDLE1BQUEsS0FBQUMsUUFBQSxzQkFBQUMsR0FBQSxvQkFBQUMsWUFBQSxFQUFBTCxJQUFBLGlGQUFBTSxZQUFBLE9BQUFDLEtBQUEsRUFBQUMsSUFBQSxHQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxHQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxHQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxHQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxHQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxHQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxHQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxHQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFlBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFlBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFlBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFlBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE9BQUFFLEtBQUEsT0FBQUMsSUFBQSxpQkFBQUMsSUFBQSxFQUFBTixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBSyxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLEtBQUFELElBQUEsVUFBQUksSUFBQSxpQkFBQUMsSUFBQSxFQUFBTixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBSyxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLEtBQUFELElBQUEsVUFBQUksSUFBQSxpQkFBQUMsSUFBQSxFQUFBTixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBSyxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLEtBQUFELElBQUEsVUFBQUksSUFBQSxhQUFBQyxJQUFBLEVBQUFOLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE1BQUFLLEdBQUEsRUFBQVAsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsS0FBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsS0FBQUQsSUFBQSxNQUFBTyxTQUFBLE9BQUFELEdBQUEsRUFBQVAsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsSUFBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsS0FBQU8sSUFBQSxNQUFBQyxTQUFBLEdBQUFWLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE1BQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxN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